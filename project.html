<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create your project</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f4f4f4;
        }

        h1, h2 {
            color: #333;
            text-align: center;
        }

        label {
            display: block;
            margin-top: 10px;
            color: #555;
        }

        input[type="text"], input[type="file"] {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        

        #employee-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #employee-list li {
            background-color: #fff;
            margin: 5px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        input[type="text"]#employee-name,
        input[type="text"]#employee-search {
            width: 100%;
            padding: 8px;
            margin-top: 10px;
            box-sizing: border-box;
        }

        button {
            background-color: #4caf50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div style="max-width: 600px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);">
        <h1>Create Your Project</h1>

        <!-- Project Name -->
        <label for="Project-name">Project name:</label>
        <input type="text" id="Project-name" placeholder="Enter Project name">
        <label for="Project-id">Project ID:</label>
        <input type="text" id="Project-id" placeholder="Enter Project ID">
        <label for="Project-desc">Project description:</label>
        <input type="text" id="Project-desc" placeholder="Enter Project description">

        <!-- Project document -->
        <label for="Project-document">Project document</label>
        <input type="file" id="Project-document" accept=".doc, .docx, .pdf">

        <!-- Add Employee Section -->
        <h2>Add Employees</h2>
        <label for="employee-name">Employee Name:</label>
        <input type="text" id="employee-name" placeholder="Enter employee name">
        <button onclick="addEmployee()">Add Employee</button>

        <!-- Display Project Employees -->
        <h2>Project Employees</h2>
        <ul id="employee-list"></ul>

        <!-- Submit Button -->
        <button onclick="submitproject()">Submit</button>
    </div>

    <!-- Firebase Configuration -->
    <script src="https://www.gstatic.com/firebasejs/9.0.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.1/firebase-database.js"></script>

    <script>
        // Replace with your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAHXbGjCTkH5X-N9T20s7PEhiZwUmGYt6A",
            projectId: "pyrank-7e5de",
            authDomain: "pyrank-7e5de.firebaseapp.com",
            databaseURL: "https://pyrank-7e5de-default-rtdb.firebaseio.com",
            storageBucket: "pyrank-7e5de.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Function to add an employee to the list
        function addEmployee() {
            const employeeName = document.getElementById('employee-name').value;
            const employeeList = document.getElementById('employee-list');

            if (employeeName) {
                const listItem = document.createElement('li');
                listItem.textContent = employeeName;
                employeeList.appendChild(listItem);

                // Reset the employee name input field
                document.getElementById('employee-name').value = '';
            } else {
                alert('Please enter an employee name.');
            }
        }

        // Function to submit project information to the database
        function submitproject() {
            const projectName = document.getElementById('project-name').value;
            const logoInput = document.getElementById('project-logo');
            const logoFile = logoInput.files[0];
            const employeeListItems = document.getElementById('employee-list').getElementsByTagName('li');

            if (projectName && logoFile && employeeListItems.length > 0) {
                const storageRef = firebase.storage().ref(`project-logos/${logoFile.name}`);
                const databaseRef = firebase.database().ref('companies');

                // Upload logo to storage
                storageRef.put(logoFile).then((snapshot) => {
                    // Get the download URL for the logo
                    snapshot.ref.getDownloadURL().then((downloadURL) => {
                        // Save project information to the database
                        const projectData = {
                            name: projectName,
                            logo: downloadURL,
                            employees: []
                        };

                        // Add employees to the project data
                        for (let i = 0; i < employeeListItems.length; i++) {
                            projectData.employees.push(employeeListItems[i].textContent);
                        }

                        databaseRef.push(projectData);

                        // Reset form fields
                        document.getElementById('project-name').value = '';
                        logoInput.value = '';
                        document.getElementById('preview').src = '';
                        document.getElementById('employee-list').innerHTML = '';
                        document.getElementById('employee-name').value = '';

                        alert('project information submitted successfully!');

                        // Redirect to the main page (index.html)
                        window.location.replace = 'index.html';
                    });
                });
            } else {
                alert('Please enter project name, select a logo, and add at least one employee.');
            }
        }
    </script>
</body>
</html>